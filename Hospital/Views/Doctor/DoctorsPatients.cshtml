@model IEnumerable<HospitalBLL.Models.PatientBLL>

@{
    ViewBag.Title = "DoctorsPatients";
}

@section Style{
    <link rel="stylesheet" href="~/Content/bootstrap.css">
    <link rel="stylesheet" href="~/Content/sweetStyle.css">

}

<h2>DoctorsPatients</h2>
<div class="container row">

    <table class="table table-hover col-lg-11 col-md-11 col-sm-12 col-xs-12" id="myTable">
        <thead class="thead-ligth">
            <tr>
                <th>
                    ФИО
                </th>
                <th>
                    Диагноз
                </th>
                <th>
                    Лекарства
                </th>
                <th>
                    Процедури
                </th>
                <th>
                    Операции
                </th>
                <th>
                    Больничная карта
                </th>
                <th>
                    Выписка
                </th>

            </tr>
        </thead>
        <tbody>
            @foreach (var item in Model)
            {

                <tr class="table-warning">
                    <td>
                        <span>
                            @Html.DisplayFor(m => item.ClientProfile.Surname)
                            @Html.DisplayFor(m => item.ClientProfile.Name)
                            @Html.DisplayFor(m => item.ClientProfile.SecondName)
                        </span>
                    </td>
                    <td>
                        @if (item.Diagnosis != null)
                        {
                            @Html.DisplayFor(m => item.Diagnosis.DiagnosisName)
                        }
                        else
                        {
                            <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#diagnosisModal">
                                Определить диагноз
                            </button>

                        }

                    </td>


                    <td>
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#DrugsModal">
                            Просмотр
                        </button>

                    </td>
                    <td>
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#ProcedureModal">
                            Просмотр
                        </button>
                    </td>

                    <td>
                        <button type="button" class="btn btn-primary" data-toggle="modal" data-target="#OperationModal">
                            Просмотр
                        </button>

                    </td>
                    <td>
                        <button type="button" class="btn btn-primary">Больничная карта</button>

                    </td>
                    <td>
                        @if (item.DrugsPrescriptions.Any(d => d.Complited == null) ||
                        item.ProcedurePrescriptions.Any(d => d.Complited == null) ||
                        item.OperatonPrescriptions.Any(d => d.Complited == null))
                        {
                            <button type="button" id="@item+'@item.IdComplaint'" value="false" class="btn btn-primary" onclick="CheckTreatment(this)">
                                Выписать пациента
                            </button>
                        }
                        else
                        {
                            <button type="button" id="@item+'@item.IdComplaint'" value="true" class="btn btn-primary" onclick="CheckTreatment(this)">
                                Выписать пациента
                            </button>
                        }

                    </td>
                </tr>


            }
        </tbody>
    </table>


</div>



<!-- The Modal -->
<div class="modal fade" id="diagnosisModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Modal Heading</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" style="min-height:400px;">
                <img class="rightImg" src="~/Images/doctor2.png" style="float:left;" height="350" width="200" />
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>




<!-- The Modal -->
<div class="modal fade" id="DrugsModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Modal Heading</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" style="min-height:400px;">
                <img class="rightImg" src="~/Images/doctor5.png" style="float:left;" height="350" width="200" />
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>





<!-- The Modal -->
<div class="modal fade" id="ProcedureModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Modal Heading</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" style="min-height:400px;">
                <img class="rightImg" src="~/Images/doctor1.png" style="float:left;" height="350" width="200" />
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>





<!-- The Modal -->
<div class="modal fade" id="OperationModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Modal Heading</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" style="min-height:400px;">
                <img class="rightImg" src="~/Images/doctor4.png" style="float:left;" height="350" width="200" />
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>


<!-- The Modal -->
<div class="modal fade" id="DischargeModal">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">

            <!-- Modal Header -->
            <div class="modal-header">
                <h4 class="modal-title">Выписка</h4>
                <button type="button" class="close" data-dismiss="modal">&times;</button>
            </div>

            <!-- Modal body -->
            <div class="modal-body" style="min-height:400px;">

                <img class="rightImg" src="~/Images/doctor4.png" style="float:left;" height="350" width="200" />
                Lorem ipsum dolor sit amet, consectetur adipiscing elit.
            </div>

            <!-- Modal footer -->
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            </div>

        </div>
    </div>
</div>


<script>

    function CheckTreatment(obj) {
       
        if (obj.value == "false") {
            Swal.fire({
                type: 'error',
                title: 'Oops...',
                html: "<p class='SwText'>Похоже что пациент не может быть выписан<p>Выполние все предписания</p></p>",
                
            });
        }
        else if (obj.value == "true") {
            Swal.fire('OK');
        }


    }


</script>